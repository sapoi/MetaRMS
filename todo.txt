
-----------------------
🙈 NOT SUPPORTED
    - validace min u referenci na klientovi (bootstrap-select nema implementovano -> pro min=1 je pot5eba nastavit required=true)
    - unique
    - search
    - moznost seradit zobrazena data
    - lazy loadig zobrazenych dat
    - pridat typ backgroundcolor - bude jako color, pro kadzy dataset max jedna -> pokud bude tento dataset referencovany nekde, tak se ta reference podbarvi tou barvou, jakou ma ten radek datasetu nastavenou jako background color
    - _editbuilderpartial -> data-subtext=" "

🕓 FURTHER WORK
    - join and parametrize create, update and delete methods due to code duplicity for data, users and rights on both server and client
    - povolit uzivatelum zpetne editovat nektere casti application descriptoru (napr popisy datasetu)
    - add support for HttpPatch to allow partial updates
    - renumber error codes for more logic
    - support for patch not just put
    - dodelat testy

-----------------------
TODO
    - remove == "username" and == "password" from code
    - pro typ bool je nullable vzdy true - proc?
    - tocici se kolecko pri validaci aplikace
    - vytvoreni admina porusi required u system user datasetu dat - vsechny hodnoty ma nevyplnene
    - zdokumentovat parametry v controllerech
    - napsat kdyz pri login se neda pripojit k "serveru" - ted to spadne
    - delsi doba prihlaseni - delsi platnost tokenu
    - salt to passwords
    - kdyz je default heslo, vyzadovat zmenu na safe
        - ✴️ zmena hesla - nekontrolovat delku/spec znaky stareho hesla - vyresi se zavedenim vynuceni zmeny default hesla
    - zobrazovat nekde jmeno prihlaseneho uzivatele - too complicated - v pages nemam user
    - ✴️🔥🔥🔥 pridat detail dat - po kliknuti na referenci - nutne - kdyz ma uzivatel pouze R prava, nezobrazil by se mu detail pomoci edit
    - ValueList jako dict <string, ...>
                C  U          x    odesilat model
        data    ✅ ✅                   ✅
        users   ✅ ✅                   ✅
        rights  ✅ ✅                   ✅
        settings              ✅        ✅
        defaultpasswordchange ✴️        ✴️
    - ❗️ refresh token (https://www.blinkingcaret.com/2018/05/30/refresh-tokens-in-asp-net-core-web-api/)
    
    REFAKTORING
        - rozdelit accesshepler 
        - pomocne app init metody z kontrolleru nekam jinam
        - presunout getTextForReference
        
    JAVASCRIPT
        - 🔥 javascript popup okna pri delete, ...
        - 🔥 users alert jestli doopravdy vyresetovat heslo
        ️- 🔥 new password equal validation
        - prilinkovat skripty 1.10. str 20

    MULTILINGUAL SUPPORT
        - preklady: nazvy tlacitek, rights dataset, rights.get nazvy sloupcu tabluky, settings
        - uzivatelum pridat jazyk a pri vytvreni uzivatale nastavit jako default jazyk aplikace + do settings dat zmenu jazyka
        - Message.GetMessage() pouzivat language

    DESIGN
        - footer
        - MOBILE VERSION
            - hamburger button in iphone
            - smaller page margin
            - no table border
            - menu without bullets
            - menu larger spaces between lines
            - logout menu not as list


    DELETE
        - ✅ ondelete action tam, kde jsou referencovani uzivatele nesmi byt cascade, aby se nevzmazal i posledni uzivatel aplikace
        - ✅ set empty na requierd atributu
        - ✅ pouze pro mazani dat a uzivatelu (rights uz se kontroluji a mohou byt referencovane jen u uzivatelu jako fk v db)
        - ✅ mazani dat - gkeep
            - ✅ pri mazani uzivatelu/dat kontrolovat, jestli na ne nekde nevede reference
        - 🧡 on delete actions (cca https://dev.mysql.com/doc/refman/8.0/en/create-table-foreign-keys.html):
            - I want to delete rowA from table1 and rowA is referenced in table2, if attribute in table@ containing rowA as reference has onDelete set to:
                - cascade - rowA will be deleted, all rows referencing rowA in table2 will be deleted
                - setEmpty - rowA will be deleted, all values of attributess referencing rowA in table2 will be set to empty
                - protect - no rows will be deleted
            - what if rowA is referenced anywhere else?
                - first check whereever rowA can be referenced and the onDelete settings -> do not start delete before this
                - check if it really is referenced
                - then 
                    - if anything is protect return message and do not delete anything
                    - if anything is cascade, check if cascade can be deleted the same way as checking if rowA can be deleted
                    - if everything is setEmpty, delete and set empty
        - ✅ uz je? - pri editu a updatu kontrolovat ze reference existuji i na serveru

-----------------------
TEXT
    - ➡️ zkusit napsat uvod k bp v anglictine
    - 🔥 ➡️ bodova osnova
        - ta 1. kapitola v budoucim case (plan toho, co se bude delat)
    - 🔥 ➡️ konkurence?
    - dokumentacni komentare
    - konkurence
    - uziv dok jako tutorial
    - 2 ukazkove aplikace
    - 3 uzivatele - programatori co chcou pripojit aplikaci (mobilni), admini, knihovnice
    ! pustit nekde na webu
    - ➡️ verejne zpristupnit nekolik ukazkovych aplikaci s jsonem a prihlasovacimi udaji na R prava ke vsem datasetum
    radkovani ne 2, ale 1 nebo 1.25
    - psat to postupne od zacatku a ne na preskacku
    - napsat uz ted podrobnou osnovu ke vsemu
    - vice prikladu v uvoduv uvodu napsat, co by mohli vsechno uzivatele chtit a potrebvat
    - v requirements to rozepsat a az nakonec dat seznam tect 
    
    - jak jsem resila validace pomoci messagi, ale vlastne by to slo pomoci modelstate, ale neslo
        - mohla jsem pouzit na validaci a prenaseni dat a erorru modelstate, ale vzhledem k tomu, ze pro jednotlive typy uzivatelem def 
          dat ve slovnicich nemuzu uvadet validation atributy, ma pro me vetsi smzsl si validace a errory posilat sama, navic ne vzdy 
          se errory poji k nejakemu poli (viz errory bez atributu) -  https://exceptionnotfound.net/asp-net-mvc-demystified-modelstate/
    - client side authentication - token validation https://auth0.com/docs/api-auth/tutorials/verify-access-token

    - udelat to jako web service
        - soap - XML a ja mam json
        - rest - ??

-----------------------
HOTOVO
    - ✅ prava nemi jit samzat, pokud je nekdo pouziva 
    - ✅ zobrazit mesage ze prava nebyla smazana 
    - ✅ crud uzivatele 
    - ✅ partial na menu logged 
    - ✅ partial menu unlogged
    - ✅ db ondelete restrict 
    - ✅ odkomentovat posilani mailu
    - ✅ partial na read auth datasets 
    - ✅ data controllers do slozky
    - ✅ vyzkouset data delete 
    - ✅ dodelat [Authorize] nad controllery
    - ✅ prodlouzit token
    - ✅ message pro data
    - ✅ rights patch messages
    - ✅ servererror.cshtml.cs - error stranky 2x
    - ✅ misto return to login page by melo byt nejprve odhlaseni a pak return
    - ✅ napsat varovani k init page
    - ✅ app name validator pred app init
    - ✅ posledni user nesmazatelny
    - ✅ chyba pri spatne zadanem hesle login
    - ✅ rights unique name
    - ✅ username unique
    - ✅ message o vytvoreni app z appinit do index
    - ✅ proc je get u login controlleru
    - ✅ user settings zmena hesla
    - ✅ misto hesla zobrazovat * index a login -> type="password"
    - ✅ edit user nezobrazovat hash u edit
    - ✅ app init kontrola validity mailu
    - ✅ napsat popis do about page
    - ✅ settings zmena hesla - zmenit aby tam bylo puvodni heslo 1x a nove heslo 2x
    - ✅ user edit check box na zmenu hesla -> ne, udelat tam tlacitko na reset hesla na nejakou defaultni hodnotu a tu si pak muze uzivatel zmenit ve svem nastaveni po prihlaseni -> default hodnota bude username
    - ✅ user additional data 
    - ✅ pouzivat description z jsonu
    - ✅ v Users dat rights tak, aby si ho mohl kazdy pojmenovat podle sebe - asi ok - rights muzou mitt jmeno
    - ✅ typy (username, float, string, ...) dat do enumu - NE musel by se zavest type "reference" a novy attribute characteristic rikajici typ reference
    - ✅ create user default heslo
    - ✅ repozitare
    - ✅ form resubmission
    - ✅ nejde create datasetu s referencema
    - ✅ odstranit z users reference
    - ✅ nejdou users
    - ✅ test repozitaru
    - ✅ pouzivat description datasetu
    - ✅ reference       R  C/U
        - users v data  ✅  ✅ 
        - data v users  ✅  ✅ 
        - data v data   ✅  ✅ 
    PODPORA TYPU
        - ✅ zmenit int na type number a min 0
        - ✅ klient zobrazovat vstupy podle typu
        - ✅ validace user data na klientovi 
        - ✅ validace pri vytvareni dat na klientovi - pomoci html
        - ✅ validace pri editu dat na klientovi  - pomoci html 
        - ✅ app init vytvareni user dat admina
        - ✅ podminky hesla (helka, znaky, ...)
        - ✅ odkazy na user datasety
        - ✅ nezobrazovat ID, ale nejake hodonty
            - ✅ reference na reference na reference otestovat
        - ✅ odstranit autoincrement
        - ✅ user patch unique name
    - ✅ Users textik brat z deskriptoru
    - ✅ vyresit async await
    - ✅ value list indexovat stringama nazven atributu a ne cisly
    - ✅ na serveru validace u controlleru dat zvlast
    - ✅ misto edit dat patch, jen popisek buttonu bude edit
    - ✅ nepouzivat v controllerech appName, ale brat id z claimu
    - ✅ prejmenovat ApplicationDescriptor.LoginAppName a .AppName na (Login)ApplicationName
    - ✅ prejmenovat LoginCredentials.ApplicationName na .LoginApplicationName
    - ✅ u dat vracet unauthorized pokud rights = none
    - ✅ ruzne druhy message - info, warneni, error
    - ✅ validace vstupu na klientovi podle app deskriptoru - co nezvaliduje html5?
    - ✅ pattern na type="tel" + popis do enumu
    - ✅ popis validni type="url"
    - ✅ reference user-user
    - ✅ validovat prava - musi mit min R na vsechny navazane datasety datasetu, na ktery ma nim R
    - ✅ validace user data na serveru
    - ✅ validace dat dat na serveru
    - ✅ odstranit login stranku - misto ni je index
    - ✅ nejdou videt polozky menu na mobilu
    - ✅ spojit rights, user a data servicy do jedne -> pridat baseservice
    - ✅ pouzivat [HttpPut]
    - ✅ mazani delat pres httpdelete
    - ✅ Server.Helpers.AuthHelper - Authorize prejmenovat na IsAuthorized a presunout do SharedLibrary
        - ✅ prepsat authorization v pages
    - ✅ JSON VALIDACE
        - ✅ json schema https://www.newtonsoft.com/jsonschema
        - ✅ app init kontrola ze je vzdy soubor v controlleru
        - ✅ validace DefaultLang - vytvorit enum a kontrolovat proti nemu
        - ✅ kontrolovat, ze je ondeleteaction z enumu
        - ✅ validace deskriptoru ye obsahuje app name a vsechno ostatni co je povinne 
        - ✅ validace typu username:
            - ✅ v user datasetu a pouze 1x
            - ✅ nikde jinde
            - ✅ required
            - ✅ unique
        - ✅ validace type password:
            - ✅ v user datasetu . password attributes a pouze 1x
            - ✅ nikde jinde
            - ✅ required
            - ✅ musi byt typu password
        - ✅ vsechny atributy:
            - ✅ kontrolovat, zda reference existuji
            - ✅ min mensi nez max
            - ✅ max > 0 pokud vyplnene
            - ✅ min > 0 pokud vyplnene
            - ✅ kdyz je atribut reference, musi mit ondeleteaction
            - ✅ ondelete action tam, kde jsou referencovani uzivatele nesmi byt cascade, aby se nevzmazal i posledni uzivatel aplikace
            - ✅ safer pouze u password
            - ✅ ondeleteaction pouze u referenci
            - ✅ reference nesmi mit min>0 a required false
            - ✅ ondeleteaction setempty nesmi byt na requierd atributu nebo attributu s min > 0
        - ✅ datasety
            - ✅ musi byt alespon jedna required polozka
            - ✅ unique jmena - zadne datasety se nesmi jmenovat stejne
            - ✅ datasety se nesmi jmenovat jako basic typy
            - ✅ nazvy datasetu nesmi obsahovat {cislo} (kvuli replaci messagi)
            - ✅ atributy - unique jmena v ramci datasetu - kazdy atribut v ramci datasetu musi mit unikatni jmeno
        - ✅ nenastavene polozky
            - ✅ u referenci kdyz je min a neni required, nastavit i requierd na true
            - ✅ u referenci kdyz je required a neni min, nastavit min na 1
            - ✅ nastavovat datasetum id
            - ✅ nastavovat user datasetu id
            - ✅ nevyplnene unique, required nastavit na false
            - ✅ pokud nevyplnene safer u password, tak nastavit na false
        - ✅ co muze byt null po ulozeni descriptoru?
            - ✅ jakukoli description, attribute . min, max, safer, ondeleteaction
        - ✅ app init validace puvodni popisy
            - ♻️ datasety se nesmi jmenovat jako basic typy
            - ♻️ nazvy datasetu nesmi obsahovat {cislo} (kvuli replaci messagi)
            - ♻️ kazdy atribut v ramci datasetu musi mit unikatni jmeno
            - ♻️ zadne datasety se nesmi jmenovat stejne
            - ♻️ username je typu username a password typu password a kazde muze byt v user datasetu prave 1x
            - ♻️ username automaticky nastavit unique
            - ♻️ username a passvord vzdy nastavit na required
            - ♻️ kdyz neni nastaveno required/unique, nastavi se pri initu na false
            - ♻️ v kazdem datasetu musi byt alespon jedna required polozka
            - ♻️ pro typ user dataset se da required nahradit min
            - ♻️ kontrolovat, zda reference existuji
            - ♻️ kdyz je v min > 0, nastavit required na true
            - ♻️ co neni true je null = false
            - ♻️ min mensi nez max
            - ♻️ kdyz je min a neni required, nastavit i requierd
            - ♻️ kdyz je atribut reference, musi mit ondeleteaction 
            - ♻️ ondelete action tam, kde jsou referencovani uzivatele nesmi byt cascade, aby se nevzmazal i posledni uzivatel aplikace
            - ♻️ nastavovat user datasetu id - AppInitController
            - ♻️ temer jakakoli hodnota atributu muze byt null!!!
    - ✅ vlozit emoji do db
    - ✅ message preparer
    - ✅ message priprava pomoci stringbuilderu

-----------------------
ZRUŠENO
    - 🅾️ pridat defalut enumy a dat je mezi podporovane typy - countries, currency, 
    - 🅾️ pridat prava CRUD+user password change -> bude je mit jen admin a bude je moct nastavovat jen admin -> jinak se da heslo zmenit poj v nastaveni prihlaseneho uzivatele
    - 🅾️ preklady se budou moct delat v app 
        - 🅾️ bude tam form na odeslani zadosti o pridani noveho jayzka
    - 🅾️ mazani rights z cache jen pro konkretni id
    - 🅾️ moznost menit barvu pozadi radku
    - 🅾️ odhlasovat pri erroru jako napr nenalayen deskriptor aplikace uyivatele?
    - 🅾️ do db a app user.language
    - 🅾️ ukladat JSON do DB pekne zformatovany
    - 🅾️ moznost smazani aplikace
    - 🅾️ moznost exportu dat
    - 🅾️ cache, ktera se postupne uci, ktera data jsou nejpouzivanejsi a ty si bude pamatovat
    - 🅾️ pridat stranku, na kterou si admin muze napsat co chce - navod na pouzivani konkretni aplikace 
    ️- 🅾️ pridat do db k datasetum created_by a modified_by
    - 🅾️ ❓ co vsechno muze prihlaseny uzivatel menit na svych user data?
    - 🅾️ pridani jayzka do descriptoru
    - 🅾️ lokalizovat zobrazeni data nebo to dat do nastaveni
    - 🅾️ odhlaseni na serveru - to vlastne nedava smysl - kdyz se odhlasim z webove aplikace, tak nechci odhlasit i z mobilni aplikace
    - 🅾️ AccountService.GetApplicationDescriptorByAppName dat nekam jinam
    - 🅾️ metoda na kontrolu tokenu a appname do Validations
    - ️️️️️🅾️ udelat a dat app name validator nekam zvlast
    - 🅾️ if user deleted, log him out first
    - 🅾️ pouzivat [HttpPatch]?
            - https://medium.com/backticks-tildes/restful-api-design-put-vs-patch-4a061aa3ed0b
                - spis se chovam jako put, navic patch neni soucastio httpclienta
    - 🅾️ JSON VALIDACE 
        - 🅾️ ukladat app descriptor jako indented https://www.newtonsoft.com/json/help/html/T_Newtonsoft_Json_Formatting.htm
        - 🅾️ reference nevede sama na sebe
        - 🅾️ reference nejsou v USER datasetu
        - 🅾️ nazvy atributu nesmi byt BDId a RIGHTSId
    
    

-----------------------
🍑 HOSTING
    - porovnani: https://www.hledej-hosting.cz/hledat/webhosting-net/?
    - https://www.aspone.cz/cz/Webhosting/Freehosting/
    - https://www.asp2.cz/
    - https://www.aspify.com/cz/webhosting/aspnet-freehosting/ - nejvice mista

    - deploy dat
        - cd RazorWebApp
        - dotnet build
        - dotnet publish
        - ...RazorWebApp/bin/Debug/netcoreapp2.0/publish/
        - https://stackoverflow.com/questions/39238850/how-to-set-aspnetcore-environment-in-publish-file
    - databaze
        - zkopirovat
        - 🍑 jak vygenerovat novou?
    - 🍑 ukazkove aplikace?

---------

JSON requirements
- minimal required structure:
    - AppName (one)
    - DefaultLanguage (one) - z nejakeho oficialniho enumu, pokusim se na nej napasovat preklad, pokud preklad pro ten jazyk nebude existovat, bere se en
    - Users (one)
        - PasswordAttribute
        - Attributes
            - Username
    - Datasets (one)
        - 
- pokud nebude v atributu nullable, bere se jako true
- pokud nebude v atributu unique, bere se jako false
- pokud nebude uvedena u atributu max hodnota, bere se jako null, tedy nekonecno
- v podstate se nemusi uvadet zadna false hodnota, protoze ta se nastavi default
- atribut Name nesmi byt nazev podporovaneho typu (jako treba bool, int, currency (ale muze byt Currency)) - kvuli if v _InputBuilderPartial




- podporované typy dat:
    - string🆗, int🆗, float🆗
    - date🆗, time🆗, datetime🆗 (kalendare a timepickery)
    - year🆗 
    - systémový dataset Users 🆗 
    - uživatelské datasety (=dají se pomocí nich vyjádřit enumy) - v roletce bude zobrazeno 1. - 3. sloupec 🆗 
    - text🆗 - multiline
    - url🆗
    - color🆗 - na zmenu barvy prostredi?
    - email🆗
    - username 🆗 - pouze v User datasetu a pouze 1x
    - password 🆗 - pouze v User datasetu v password attribute
    - bool 🆗 

    - required pro libovolny typ

    - min/max pro int, float ... TODO pro date, time, datetime

- atributy
    🆗 "Name": vsechno, povinne, unikatni
    🆗 "Description": vsechno, nepovinny
    🆗 "Type": vsechno, povinne, na vyber z podporovanych typu
    🆗 "Required": vsechno, true x false, nepovinny
    🅾️ "Unique": TODO
    🆗 "Safer": true x false, jen password TODO test
    🆗 "Min": cislo, jen pro int, float, reference, a nove i jen pro string, text, username, password
    🆗 "Max": cislo, jen pro int, float, reference, a nove i jen pro string, text, username, password


- podminky
    - zadne datasety se nesmi jmenovat stejne

- system datasety
    - uz obsahuji prava









